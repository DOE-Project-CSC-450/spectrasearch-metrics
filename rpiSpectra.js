/*
This script calculates chromaticity coordinates, CCT, CRI, GAI, and FSCI
for a 2856 blackbody source (illuminant A).  To use other sources, just
replace the spd matrix with the values for the other source.
*/


/*====================================  DATA  ==================================== */
//Light source SPD
//   The light source spd is entered in a 2-column format as shown below.
//   [wavelength (nm)    value]
spd =[
      [380,0.00132948037347175],
      [390,0.00164023432576807],
      [400,0.00199607408541092],
      [410,0.00239863299576014],
      [420,0.00284898784428011],
      [430,0.00334764547822949],
      [440,0.00389454498476917],
      [450,0.0044890736644276],
      [460,0.00513009474369056],
      [470,0.00581598464137424],
      [480,0.00654467759688934],
      [490,0.00731371555834619],
      [500,0.00812030138807687],
      [510,0.00896135364886274],
      [520,0.00983356146587939],
      [530,0.0107334382008557],
      [540,0.0116573729136429],
      [550,0.0126016788131223],
      [560,0.0135626381078808],
      [570,0.0145365428535139],
      [580,0.0155197315558729],
      [590,0.0165086214276558],
      [600,0.0174997363101301],
      [610,0.0184897303639286],
      [620,0.0194754077047119],
      [630,0.0204537382132532],
      [640,0.0214218697874947],
      [650,0.022377137328638],
      [660,0.0233170687665763],
      [670,0.0242393884339735],
      [680,0.0251420180949075],
      [690,0.0260230759248419],
      [700,0.026880873725211],
      [710,0.0277139126393038],
      [720,0.0285208776174515],
      [730,0.0293006308595934],
      [740,0.0300522044428256],
      [750,0.0307747923210527],
      [760,0.0314677418638086],
      [770,0.0321305450820022],
      [780,0.0327628296700076]
];


var wavelength_spd = spd.map(function(value,index) { return value[0]; });
var spd = spd.map(function(value,index) { return value[1]; });

/*
First, obtain reference data values
The CIE 1931 2 degree Standard Colorimetric Observer
[wavelength(nm)   xbar    ybar zbar]
*/
CIE31Table = [
      [360,0.000130,0.000004,0.000606],
      [361,0.000146,0.000004,0.000681],
      [362,0.000164,0.000005,0.000765],
      [363,0.000184,0.000006,0.000860],
      [364,0.000207,0.000006,0.000967],
      [365,0.000232,0.000007,0.001086],
      [366,0.000261,0.000008,0.001221],
      [367,0.000293,0.000009,0.001373],
      [368,0.000329,0.000010,0.001544],
      [369,0.000370,0.000011,0.001734],
      [370,0.000415,0.000012,0.001946],
      [371,0.000464,0.000014,0.002178],
      [372,0.000519,0.000016,0.002436],
      [373,0.000582,0.000017,0.002732],
      [374,0.000655,0.000020,0.003078],
      [375,0.000742,0.000022,0.003486],
      [376,0.000845,0.000025,0.003975],
      [377,0.000965,0.000028,0.004541],
      [378,0.001095,0.000032,0.005158],
      [379,0.001231,0.000035,0.005803],
      [380,0.001368,0.000039,0.006450],
      [381,0.001502,0.000043,0.007083],
      [382,0.001642,0.000047,0.007745],
      [383,0.001802,0.000052,0.008501],
      [384,0.001996,0.000057,0.009415],
      [385,0.002236,0.000064,0.010550],
      [386,0.002535,0.000072,0.011966],
      [387,0.002893,0.000082,0.013656],
      [388,0.003301,0.000094,0.015588],
      [389,0.003753,0.000106,0.017730],
      [390,0.004243,0.000120,0.020050],
      [391,0.004762,0.000135,0.022511],
      [392,0.005330,0.000151,0.025203],
      [393,0.005979,0.000170,0.028280],
      [394,0.006741,0.000192,0.031897],
      [395,0.007650,0.000217,0.036210],
      [396,0.008751,0.000247,0.041438],
      [397,0.010029,0.000281,0.047504],
      [398,0.011422,0.000319,0.054120],
      [399,0.012869,0.000357,0.060998],
      [400,0.014310,0.000396,0.067850],
      [401,0.015704,0.000434,0.074486],
      [402,0.017147,0.000473,0.081362],
      [403,0.018781,0.000518,0.089154],
      [404,0.020748,0.000572,0.098540],
      [405,0.023190,0.000640,0.110200],
      [406,0.026207,0.000725,0.124613],
      [407,0.029782,0.000825,0.141702],
      [408,0.033881,0.000941,0.161303],
      [409,0.038468,0.001070,0.183257],
      [410,0.043510,0.001210,0.207400],
      [411,0.048996,0.001362,0.233692],
      [412,0.055023,0.001531,0.262611],
      [413,0.061719,0.001720,0.294775],
      [414,0.069212,0.001935,0.330799],
      [415,0.077630,0.002180,0.371300],
      [416,0.086958,0.002455,0.416209],
      [417,0.097177,0.002764,0.465464],
      [418,0.108406,0.003118,0.519695],
      [419,0.120767,0.003526,0.579530],
      [420,0.134380,0.004000,0.645600],
      [421,0.149358,0.004546,0.718484],
      [422,0.165396,0.005159,0.796713],
      [423,0.181983,0.005829,0.877846],
      [424,0.198611,0.006546,0.959439],
      [425,0.214770,0.007300,1.039050],
      [426,0.230187,0.008087,1.115367],
      [427,0.244880,0.008909,1.188497],
      [428,0.258777,0.009768,1.258123],
      [429,0.271808,0.010664,1.323930],
      [430,0.283900,0.011600,1.385600],
      [431,0.294944,0.012573,1.442635],
      [432,0.304897,0.013583,1.494804],
      [433,0.313787,0.014630,1.542190],
      [434,0.321645,0.015715,1.584881],
      [435,0.328500,0.016840,1.622960],
      [436,0.334351,0.018007,1.656405],
      [437,0.339210,0.019214,1.685296],
      [438,0.343121,0.020454,1.709875],
      [439,0.346130,0.021718,1.730382],
      [440,0.348280,0.023000,1.747060],
      [441,0.349600,0.024295,1.760045],
      [442,0.350147,0.025610,1.769623],
      [443,0.350013,0.026959,1.776264],
      [444,0.349287,0.028351,1.780433],
      [445,0.348060,0.029800,1.782600],
      [446,0.346373,0.031311,1.782968],
      [447,0.344262,0.032884,1.781700],
      [448,0.341809,0.034521,1.779198],
      [449,0.339094,0.036226,1.775867],
      [450,0.336200,0.038000,1.772110],
      [451,0.333198,0.039847,1.768259],
      [452,0.330041,0.041768,1.764039],
      [453,0.326636,0.043766,1.758944],
      [454,0.322887,0.045843,1.752466],
      [455,0.318700,0.048000,1.744100],
      [456,0.314025,0.050244,1.733559],
      [457,0.308884,0.052573,1.720858],
      [458,0.303290,0.054981,1.705937],
      [459,0.297258,0.057459,1.688737],
      [460,0.290800,0.060000,1.669200],
      [461,0.283970,0.062602,1.647529],
      [462,0.276721,0.065278,1.623413],
      [463,0.268918,0.068042,1.596022],
      [464,0.260423,0.070911,1.564528],
      [465,0.251100,0.073900,1.528100],
      [466,0.240847,0.077016,1.486111],
      [467,0.229851,0.080266,1.439521],
      [468,0.218407,0.083667,1.389880],
      [469,0.206812,0.087233,1.338736],
      [470,0.195360,0.090980,1.287640],
      [471,0.184214,0.094918,1.237422],
      [472,0.173327,0.099046,1.187824],
      [473,0.162688,0.103367,1.138761],
      [474,0.152283,0.107885,1.090148],
      [475,0.142100,0.112600,1.041900],
      [476,0.132179,0.117532,0.994198],
      [477,0.122570,0.122674,0.947347],
      [478,0.113275,0.127993,0.901453],
      [479,0.104298,0.133453,0.856619],
      [480,0.095640,0.139020,0.812950],
      [481,0.087300,0.144676,0.770517],
      [482,0.079308,0.150469,0.729445],
      [483,0.071718,0.156462,0.689914],
      [484,0.064581,0.162718,0.652105],
      [485,0.057950,0.169300,0.616200],
      [486,0.051862,0.176243,0.582329],
      [487,0.046282,0.183558,0.550416],
      [488,0.041151,0.191274,0.520338],
      [489,0.036413,0.199418,0.491967],
      [490,0.032010,0.208020,0.465180],
      [491,0.027917,0.217120,0.439925],
      [492,0.024144,0.226735,0.416184],
      [493,0.020687,0.236857,0.393882],
      [494,0.017540,0.247481,0.372946],
      [495,0.014700,0.258600,0.353300],
      [496,0.012162,0.270185,0.334858],
      [497,0.009920,0.282294,0.317552],
      [498,0.007967,0.295050,0.301337],
      [499,0.006296,0.308578,0.286169],
      [500,0.004900,0.323000,0.272000],
      [501,0.003777,0.338402,0.258817],
      [502,0.002945,0.354686,0.246484],
      [503,0.002425,0.371699,0.234772],
      [504,0.002236,0.389288,0.223453],
      [505,0.002400,0.407300,0.212300],
      [506,0.002926,0.425630,0.201169],
      [507,0.003837,0.444310,0.190120],
      [508,0.005175,0.463394,0.179225],
      [509,0.006982,0.482940,0.168561],
      [510,0.009300,0.503000,0.158200],
      [511,0.012149,0.523569,0.148138],
      [512,0.015536,0.544512,0.138376],
      [513,0.019478,0.565690,0.128994],
      [514,0.023993,0.586965,0.120075],
      [515,0.029100,0.608200,0.111700],
      [516,0.034815,0.629346,0.103905],
      [517,0.041120,0.650307,0.096667],
      [518,0.047985,0.670875,0.089983],
      [519,0.055379,0.690842,0.083845],
      [520,0.063270,0.710000,0.078250],
      [521,0.071635,0.728185,0.073209],
      [522,0.080462,0.745464,0.068678],
      [523,0.089740,0.761969,0.064568],
      [524,0.099456,0.777837,0.060788],
      [525,0.109600,0.793200,0.057250],
      [526,0.120167,0.808110,0.053904],
      [527,0.131114,0.822496,0.050747],
      [528,0.142368,0.836307,0.047753],
      [529,0.153854,0.849492,0.044899],
      [530,0.165500,0.862000,0.042160],
      [531,0.177257,0.873811,0.039507],
      [532,0.189140,0.884962,0.036936],
      [533,0.201169,0.895494,0.034458],
      [534,0.213366,0.905443,0.032089],
      [535,0.225750,0.914850,0.029840],
      [536,0.238321,0.923735,0.027712],
      [537,0.251067,0.932092,0.025694],
      [538,0.263992,0.939923,0.023787],
      [539,0.277102,0.947225,0.021989],
      [540,0.290400,0.954000,0.020300],
      [541,0.303891,0.960256,0.018718],
      [542,0.317573,0.966007,0.017240],
      [543,0.331438,0.971261,0.015864],
      [544,0.345483,0.976023,0.014585],
      [545,0.359700,0.980300,0.013400],
      [546,0.374084,0.984092,0.012307],
      [547,0.388640,0.987418,0.011302],
      [548,0.403378,0.990313,0.010378],
      [549,0.418312,0.992812,0.009529],
      [550,0.433450,0.994950,0.008750],
      [551,0.448795,0.996711,0.008035],
      [552,0.464336,0.998098,0.007382],
      [553,0.480064,0.999112,0.006785],
      [554,0.495971,0.999748,0.006243],
      [555,0.512050,1.000000,0.005750],
      [556,0.528296,0.999857,0.005304],
      [557,0.544692,0.999305,0.004900],
      [558,0.561209,0.998325,0.004534],
      [559,0.577821,0.996899,0.004202],
      [560,0.594500,0.995000,0.003900],
      [561,0.611221,0.992601,0.003623],
      [562,0.627976,0.989743,0.003371],
      [563,0.644760,0.986444,0.003141],
      [564,0.661570,0.982724,0.002935],
      [565,0.678400,0.978600,0.002750],
      [566,0.695239,0.974084,0.002585],
      [567,0.712059,0.969171,0.002439],
      [568,0.728828,0.963857,0.002309],
      [569,0.745519,0.958135,0.002197],
      [570,0.762100,0.952000,0.002100],
      [571,0.778543,0.945450,0.002018],
      [572,0.794826,0.938499,0.001948],
      [573,0.810926,0.931163,0.001890],
      [574,0.826825,0.923458,0.001841],
      [575,0.842500,0.915400,0.001800],
      [576,0.857932,0.907006,0.001766],
      [577,0.873082,0.898277,0.001738],
      [578,0.887894,0.889205,0.001711],
      [579,0.902318,0.879782,0.001683],
      [580,0.916300,0.870000,0.001650],
      [581,0.929800,0.859861,0.001610],
      [582,0.942798,0.849392,0.001564],
      [583,0.955278,0.838622,0.001514],
      [584,0.967218,0.827581,0.001459],
      [585,0.978600,0.816300,0.001400],
      [586,0.989386,0.804795,0.001337],
      [587,0.999549,0.793082,0.001270],
      [588,1.009089,0.781192,0.001205],
      [589,1.018006,0.769155,0.001147],
      [590,1.026300,0.757000,0.001100],
      [591,1.033983,0.744754,0.001069],
      [592,1.040986,0.732422,0.001049],
      [593,1.047188,0.720004,0.001036],
      [594,1.052467,0.707496,0.001021],
      [595,1.056700,0.694900,0.001000],
      [596,1.059794,0.682219,0.000969],
      [597,1.061799,0.669472,0.000930],
      [598,1.062807,0.656674,0.000887],
      [599,1.062910,0.643845,0.000843],
      [600,1.062200,0.631000,0.000800],
      [601,1.060735,0.618155,0.000761],
      [602,1.058444,0.605314,0.000724],
      [603,1.055224,0.592476,0.000686],
      [604,1.050977,0.579638,0.000645],
      [605,1.045600,0.566800,0.000600],
      [606,1.039037,0.553961,0.000548],
      [607,1.031361,0.541137,0.000492],
      [608,1.022666,0.528353,0.000435],
      [609,1.013048,0.515632,0.000383],
      [610,1.002600,0.503000,0.000340],
      [611,0.991367,0.490469,0.000307],
      [612,0.979331,0.478030,0.000283],
      [613,0.966492,0.465678,0.000265],
      [614,0.952848,0.453403,0.000252],
      [615,0.938400,0.441200,0.000240],
      [616,0.923194,0.429080,0.000230],
      [617,0.907244,0.417036,0.000221],
      [618,0.890502,0.405032,0.000212],
      [619,0.872920,0.393032,0.000202],
      [620,0.854450,0.381000,0.000190],
      [621,0.835084,0.368918,0.000174],
      [622,0.814946,0.356827,0.000156],
      [623,0.794186,0.344777,0.000136],
      [624,0.772954,0.332818,0.000117],
      [625,0.751400,0.321000,0.000100],
      [626,0.729584,0.309338,0.000086],
      [627,0.707589,0.297850,0.000075],
      [628,0.685602,0.286594,0.000065],
      [629,0.663810,0.275624,0.000057],
      [630,0.642400,0.265000,0.000050],
      [631,0.621515,0.254763,0.000044],
      [632,0.601114,0.244890,0.000039],
      [633,0.581105,0.235334,0.000036],
      [634,0.561398,0.226053,0.000033],
      [635,0.541900,0.217000,0.000030],
      [636,0.522599,0.208162,0.000028],
      [637,0.503546,0.199549,0.000026],
      [638,0.484744,0.191155,0.000024],
      [639,0.466194,0.182974,0.000022],
      [640,0.447900,0.175000,0.000020],
      [641,0.429861,0.167224,0.000018],
      [642,0.412098,0.159646,0.000016],
      [643,0.394644,0.152278,0.000014],
      [644,0.377533,0.145126,0.000012],
      [645,0.360800,0.138200,0.000010],
      [646,0.344456,0.131500,0.000008],
      [647,0.328517,0.125025,0.000005],
      [648,0.313019,0.118779,0.000003],
      [649,0.298001,0.112769,0.000001],
      [650,0.283500,0.107000,0.000000],
      [651,0.269545,0.101476,0.000000],
      [652,0.256118,0.096189,0.000000],
      [653,0.243190,0.091123,0.000000],
      [654,0.230727,0.086265,0.000000],
      [655,0.218700,0.081600,0.000000],
      [656,0.207097,0.077121,0.000000],
      [657,0.195923,0.072826,0.000000],
      [658,0.185171,0.068710,0.000000],
      [659,0.174832,0.064770,0.000000],
      [660,0.164900,0.061000,0.000000],
      [661,0.155367,0.057396,0.000000],
      [662,0.146230,0.053955,0.000000],
      [663,0.137490,0.050674,0.000000],
      [664,0.129147,0.047550,0.000000],
      [665,0.121200,0.044580,0.000000],
      [666,0.113640,0.041759,0.000000],
      [667,0.106465,0.039085,0.000000],
      [668,0.099690,0.036564,0.000000],
      [669,0.093331,0.034200,0.000000],
      [670,0.087400,0.032000,0.000000],
      [671,0.081901,0.029963,0.000000],
      [672,0.076804,0.028077,0.000000],
      [673,0.072077,0.026329,0.000000],
      [674,0.067687,0.024708,0.000000],
      [675,0.063600,0.023200,0.000000],
      [676,0.059807,0.021801,0.000000],
      [677,0.056282,0.020501,0.000000],
      [678,0.052971,0.019281,0.000000],
      [679,0.049819,0.018121,0.000000],
      [680,0.046770,0.017000,0.000000],
      [681,0.043784,0.015904,0.000000],
      [682,0.040875,0.014837,0.000000],
      [683,0.038073,0.013811,0.000000],
      [684,0.035405,0.012835,0.000000],
      [685,0.032900,0.011920,0.000000],
      [686,0.030564,0.011068,0.000000],
      [687,0.028381,0.010273,0.000000],
      [688,0.026345,0.009533,0.000000],
      [689,0.024453,0.008846,0.000000],
      [690,0.022700,0.008210,0.000000],
      [691,0.021084,0.007624,0.000000],
      [692,0.019600,0.007085,0.000000],
      [693,0.018237,0.006591,0.000000],
      [694,0.016987,0.006138,0.000000],
      [695,0.015840,0.005723,0.000000],
      [696,0.014791,0.005343,0.000000],
      [697,0.013831,0.004996,0.000000],
      [698,0.012949,0.004676,0.000000],
      [699,0.012129,0.004380,0.000000],
      [700,0.011359,0.004102,0.000000],
      [701,0.010629,0.003838,0.000000],
      [702,0.009939,0.003589,0.000000],
      [703,0.009288,0.003354,0.000000],
      [704,0.008679,0.003134,0.000000],
      [705,0.008111,0.002929,0.000000],
      [706,0.007582,0.002738,0.000000],
      [707,0.007089,0.002560,0.000000],
      [708,0.006627,0.002393,0.000000],
      [709,0.006195,0.002237,0.000000],
      [710,0.005790,0.002091,0.000000],
      [711,0.005410,0.001954,0.000000],
      [712,0.005053,0.001825,0.000000],
      [713,0.004718,0.001704,0.000000],
      [714,0.004404,0.001590,0.000000],
      [715,0.004109,0.001484,0.000000],
      [716,0.003834,0.001384,0.000000],
      [717,0.003576,0.001291,0.000000],
      [718,0.003334,0.001204,0.000000],
      [719,0.003109,0.001123,0.000000],
      [720,0.002899,0.001047,0.000000],
      [721,0.002704,0.000977,0.000000],
      [722,0.002523,0.000911,0.000000],
      [723,0.002354,0.000850,0.000000],
      [724,0.002197,0.000793,0.000000],
      [725,0.002049,0.000740,0.000000],
      [726,0.001911,0.000690,0.000000],
      [727,0.001781,0.000643,0.000000],
      [728,0.001660,0.000599,0.000000],
      [729,0.001546,0.000558,0.000000],
      [730,0.001440,0.000520,0.000000],
      [731,0.001340,0.000484,0.000000],
      [732,0.001246,0.000450,0.000000],
      [733,0.001158,0.000418,0.000000],
      [734,0.001076,0.000389,0.000000],
      [735,0.001000,0.000361,0.000000],
      [736,0.000929,0.000335,0.000000],
      [737,0.000862,0.000311,0.000000],
      [738,0.000801,0.000289,0.000000],
      [739,0.000743,0.000268,0.000000],
      [740,0.000690,0.000249,0.000000],
      [741,0.000641,0.000231,0.000000],
      [742,0.000595,0.000215,0.000000],
      [743,0.000552,0.000199,0.000000],
      [744,0.000512,0.000185,0.000000],
      [745,0.000476,0.000172,0.000000],
      [746,0.000442,0.000160,0.000000],
      [747,0.000412,0.000149,0.000000],
      [748,0.000383,0.000138,0.000000],
      [749,0.000357,0.000129,0.000000],
      [750,0.000332,0.000120,0.000000],
      [751,0.000310,0.000112,0.000000],
      [752,0.000289,0.000104,0.000000],
      [753,0.000270,0.000097,0.000000],
      [754,0.000252,0.000091,0.000000],
      [755,0.000235,0.000085,0.000000],
      [756,0.000219,0.000079,0.000000],
      [757,0.000205,0.000074,0.000000],
      [758,0.000191,0.000069,0.000000],
      [759,0.000178,0.000064,0.000000],
      [760,0.000166,0.000060,0.000000],
      [761,0.000155,0.000056,0.000000],
      [762,0.000145,0.000052,0.000000],
      [763,0.000135,0.000049,0.000000],
      [764,0.000126,0.000045,0.000000],
      [765,0.000117,0.000042,0.000000],
      [766,0.000110,0.000040,0.000000],
      [767,0.000102,0.000037,0.000000],
      [768,0.000095,0.000034,0.000000],
      [769,0.000089,0.000032,0.000000],
      [770,0.000083,0.000030,0.000000],
      [771,0.000078,0.000028,0.000000],
      [772,0.000072,0.000026,0.000000],
      [773,0.000067,0.000024,0.000000],
      [774,0.000063,0.000023,0.000000],
      [775,0.000059,0.000021,0.000000],
      [776,0.000055,0.000020,0.000000],
      [777,0.000051,0.000018,0.000000],
      [778,0.000048,0.000017,0.000000],
      [779,0.000044,0.000016,0.000000],
      [780,0.000042,0.000015,0.000000],
      [781,0.000039,0.000014,0.000000],
      [782,0.000036,0.000013,0.000000],
      [783,0.000034,0.000012,0.000000],
      [784,0.000031,0.000011,0.000000],
      [785,0.000029,0.000011,0.000000],
      [786,0.000027,0.000010,0.000000],
      [787,0.000026,0.000009,0.000000],
      [788,0.000024,0.000009,0.000000],
      [789,0.000022,0.000008,0.000000],
      [790,0.000021,0.000007,0.000000],
      [791,0.000019,0.000007,0.000000],
      [792,0.000018,0.000006,0.000000],
      [793,0.000017,0.000006,0.000000],
      [794,0.000016,0.000006,0.000000],
      [795,0.000015,0.000005,0.000000],
      [796,0.000014,0.000005,0.000000],
      [797,0.000013,0.000005,0.000000],
      [798,0.000012,0.000004,0.000000],
      [799,0.000011,0.000004,0.000000],
      [800,0.000010,0.000004,0.000000],
      [801,0.000010,0.000003,0.000000],
      [802,0.000009,0.000003,0.000000],
      [803,0.000008,0.000003,0.000000],
      [804,0.000008,0.000003,0.000000],
      [805,0.000007,0.000003,0.000000],
      [806,0.000007,0.000002,0.000000],
      [807,0.000006,0.000002,0.000000],
      [808,0.000006,0.000002,0.000000],
      [809,0.000005,0.000002,0.000000],
      [810,0.000005,0.000002,0.000000],
      [811,0.000005,0.000002,0.000000],
      [812,0.000004,0.000002,0.000000],
      [813,0.000004,0.000001,0.000000],
      [814,0.000004,0.000001,0.000000],
      [815,0.000004,0.000001,0.000000],
      [816,0.000003,0.000001,0.000000],
      [817,0.000003,0.000001,0.000000],
      [818,0.000003,0.000001,0.000000],
      [819,0.000003,0.000001,0.000000],
      [820,0.000003,0.000001,0.000000],
      [821,0.000002,0.000001,0.000000],
      [822,0.000002,0.000001,0.000000],
      [823,0.000002,0.000001,0.000000],
      [824,0.000002,0.000001,0.000000],
      [825,0.000002,0.000001,0.000000],
      [826,0.000002,0.000001,0.000000],
      [827,0.000002,0.000001,0.000000],
      [828,0.000001,0.000001,0.000000],
      [829,0.000001,0.000000,0.000000],
      [830,0.000001,0.000000,0.000000]
];

var wavelength = CIE31Table.map(function(value,index) { return value[0]; });
var xbar = CIE31Table.map(function(value,index) { return value[1]; });
var ybar = CIE31Table.map(function(value,index) { return value[2]; });
var zbar = CIE31Table.map(function(value,index) { return value[3]; });

/*
The spectral reflectance data of 14 color test samples for CRI
[wavelength (nm) TCS1 TCS2 TCS3 ... TCS14] 
*/
TCS =  [
      [360,116,53,58,57,143,79,150,75,69,42,74,189,71,36],
      [365,136,55,59,59,187,81,177,78,72,43,79,175,76,36],
      [370,159,59,61,62,233,89,218,84,73,45,86,158,82,36],
      [375,190,64,63,67,269,113,293,90,70,47,98,139,90,36],
      [380,219,70,65,74,295,151,378,104,66,50,111,120,104,36],
      [385,239,79,68,83,306,203,459,129,62,54,121,103,127,36],
      [390,252,89,70,93,310,265,524,170,58,59,127,90,161,37],
      [395,256,101,72,105,312,339,546,240,55,63,129,82,211,38],
      [400,256,111,73,116,313,410,551,319,52,66,127,76,264,39],
      [405,254,116,73,121,315,464,555,416,52,67,121,68,313,39],
      [410,252,118,74,124,319,492,559,462,51,68,116,64,341,40],
      [415,248,120,74,126,322,508,560,482,50,69,112,65,352,41],
      [420,244,121,74,128,326,517,561,490,50,69,108,75,359,42],
      [425,240,122,73,131,330,524,558,488,49,70,105,93,361,42],
      [430,237,122,73,135,334,531,556,482,48,72,104,123,364,43],
      [435,232,122,73,139,339,538,551,473,47,73,104,160,365,44],
      [440,230,123,73,144,346,544,544,462,46,76,105,207,367,44],
      [445,226,124,73,151,352,551,535,450,44,78,106,256,369,45],
      [450,225,127,74,161,360,556,522,439,42,83,110,300,372,45],
      [455,222,128,75,172,369,556,506,426,41,88,115,331,374,46],
      [460,220,131,77,186,381,554,488,413,38,95,123,346,376,47],
      [465,218,134,80,205,394,549,469,397,35,103,134,347,379,48],
      [470,216,138,85,229,403,541,448,382,33,113,148,341,384,50],
      [475,214,143,94,254,410,531,429,366,31,125,167,328,389,52],
      [480,214,150,109,281,415,519,408,352,30,142,192,307,397,55],
      [485,214,159,126,308,418,504,385,337,29,162,219,282,405,57],
      [490,216,174,148,332,419,488,363,325,28,189,252,257,416,62],
      [495,218,190,172,352,417,469,341,310,28,219,291,230,429,67],
      [500,223,207,198,370,413,450,324,299,28,262,325,204,443,75],
      [505,225,225,221,383,409,431,311,289,29,305,347,178,454,83],
      [510,226,242,241,390,403,414,301,283,30,365,356,154,461,92],
      [515,226,253,260,394,396,395,291,276,30,416,353,129,466,100],
      [520,225,260,278,395,389,377,283,270,31,465,346,109,469,108],
      [525,225,264,302,392,381,358,273,262,31,509,333,90,471,121],
      [530,227,267,339,385,372,341,265,256,32,546,314,75,474,133],
      [535,230,269,370,377,363,325,260,251,32,581,294,62,476,142],
      [540,236,272,392,367,353,309,257,250,33,610,271,51,483,150],
      [545,245,276,399,354,342,293,257,251,34,634,248,41,490,154],
      [550,253,282,400,341,331,279,259,254,35,653,227,35,506,155],
      [555,262,289,393,327,320,265,260,258,37,666,206,29,526,152],
      [560,272,299,380,312,308,253,260,264,41,678,188,25,553,147],
      [565,283,309,365,296,296,241,258,269,44,687,170,22,582,140],
      [570,298,322,349,280,284,234,256,272,48,693,153,19,618,133],
      [575,318,329,332,263,271,227,254,274,52,698,138,17,651,125],
      [580,341,335,315,247,260,225,254,278,60,701,125,17,680,118],
      [585,367,339,299,229,247,222,259,284,76,704,114,17,701,112],
      [590,390,341,285,214,232,221,270,295,102,705,106,16,717,106],
      [595,409,341,272,198,220,220,284,316,136,705,100,16,729,101],
      [600,424,342,264,185,210,220,302,348,190,706,96,16,736,98],
      [605,435,342,257,175,200,220,324,384,256,707,92,16,742,95],
      [610,442,342,252,169,194,220,344,434,336,707,90,16,745,93],
      [615,448,341,247,164,189,220,362,482,418,707,87,16,747,90],
      [620,450,341,241,160,185,223,377,528,505,708,85,16,748,89],
      [625,451,339,235,156,183,227,389,568,581,708,82,16,748,87],
      [630,451,339,229,154,180,233,400,604,641,710,80,18,748,86],
      [635,451,338,224,152,177,239,410,629,682,711,79,18,748,85],
      [640,451,338,220,151,176,244,420,648,717,712,78,18,748,84],
      [645,451,337,217,149,175,251,429,663,740,714,78,18,748,84],
      [650,450,336,216,148,175,258,438,676,758,716,78,19,748,84],
      [655,450,335,216,148,175,263,445,685,770,718,78,20,748,84],
      [660,451,334,219,148,175,268,452,693,781,720,81,23,747,85],
      [665,451,332,224,149,177,273,457,700,790,722,83,24,747,87],
      [670,453,332,230,151,180,278,462,705,797,725,88,26,747,92],
      [675,454,331,238,154,183,281,466,709,803,729,93,30,747,96],
      [680,455,331,251,158,186,283,468,712,809,731,102,35,747,102],
      [685,457,330,269,162,189,286,470,715,814,735,112,43,747,110],
      [690,458,329,288,165,192,291,473,717,819,739,125,56,747,123],
      [695,460,328,312,168,195,296,477,719,824,742,141,74,746,137],
      [700,462,328,340,170,199,302,483,721,828,746,161,97,746,152],
      [705,463,327,366,171,200,313,489,720,830,748,182,128,746,169],
      [710,464,326,390,170,199,325,496,719,831,749,203,166,745,188],
      [715,465,325,412,168,198,338,503,722,833,751,223,210,744,207],
      [720,466,324,431,166,196,351,511,725,835,753,242,257,743,226],
      [725,466,324,447,164,195,364,518,727,836,754,257,305,744,243],
      [730,466,324,460,164,195,376,525,729,836,755,270,354,745,260],
      [735,466,323,472,165,196,389,532,730,837,755,282,401,748,277],
      [740,467,322,481,168,197,401,539,730,838,755,292,446,750,294],
      [745,467,321,488,172,200,413,546,730,839,755,302,485,750,310],
      [750,467,320,493,177,203,425,553,730,839,756,310,520,749,325],
      [755,467,318,497,181,205,436,559,730,839,757,314,551,748,339],
      [760,467,316,500,185,208,447,565,730,839,758,317,577,748,353],
      [765,467,315,502,189,212,458,570,730,839,759,323,599,747,366],
      [770,467,315,505,192,215,469,575,730,839,759,330,618,747,379],
      [775,467,314,510,194,217,477,578,730,839,759,334,633,747,390],
      [780,467,314,516,197,219,485,581,730,839,759,338,645,747,399],
      [785,467,313,520,200,222,493,583,730,839,759,343,656,746,408],
      [790,467,313,524,204,226,500,585,731,839,759,348,666,746,416],
      [795,466,312,527,210,231,506,587,731,839,759,353,674,746,422],
      [800,466,312,531,218,237,512,588,731,839,759,359,680,746,428],
      [805,466,311,535,225,243,517,589,731,839,759,365,686,745,434],
      [810,466,311,539,233,249,521,590,731,838,758,372,691,745,439],
      [815,466,311,544,243,257,525,590,731,837,757,380,694,745,444],
      [820,465,311,548,254,265,529,590,731,837,757,388,697,745,448],
      [825,464,311,552,264,273,532,591,731,836,756,396,700,745,451],
      [830,464,310,555,274,280,535,592,731,836,756,403,702,745,454]
];

//in TCS, the column of index 1 needs to be / 1000
TCS = TCS.map(function(value,index) { 
  return [value[0],value[1]/1000,value[2],value[3],value[4],value[5],value[6],value[7],value[8],value[9],value[10],value[11],value[12],value[13],value[14]]; 
});

/*====================================  ISOTEMPERATURE LINES  ==================================== */

/*
Data for isotemperature lines needed for calculating correlated color temperature

The following provides a table of isotemperature lines for use with the Robertson Method
(Robertson, 1968) to interpolate isotemperature lines from the CIE 1960 UCS.
The spacing of the isotemp lines is very small (1 1/MK) so very little
interpolation is actually needed for determining CCT. The latest (2002)
recommended values for the physical constants determining blackbody
radiation spectra are used 
*/

//dwave in matlab is [1,1] so unsure why it matters or how it relates to wavelength, it does not appear to 
//increment wavelength in the MATLAB view as the comment indicates
//dwave = wavelength(2)-wavelength(1); //wavelength increment = 1 nm

var ubar = [];
var wbar = [];
for (var i = 0; i < xbar.length; i++) {
    ubar.push(xbar[i]*(2/3));
    wbar.push((xbar[i]*(-0.5))+(ybar[i]*(3/2))+(zbar[i]*0.5));
}
var vbar = ybar.slice();


// 2002 CODATA recommended values
var h = 6.6260693e-34;
var c = 299792458;
var k = 1.3806505e-23;
var c1 = 2*Math.PI*h*Math.pow(c,2);
var c2 = h*c/k;
var T = [];
var sdpref;
//this could be a problem
for(i=1; i<=600; i++){
  T.push(1./(i*1e-6)); //mega reciprocal Kelvin values of isotemperature lines
}

//COME BACK AND FIX THIS (harcoded)
// for i = 1:length(T)
//    spdref = c1 * ((1e-9)*wavelength).^-5 ./ (exp(c2./(T(i).* 1e-9*wavelength)) - 1);
   // spdref = spdref/max(spdref);
   // wave = wavelength*1e-9;
var spdref = [8.254033e-05,8.699432e-05,9.165853e-05,9.654135e-05,1.016515e-04,1.069978e-04,1.125895e-04,1.184362e-04,1.245476e-04,1.309338e-04,1.376053e-04,1.445726e-04,1.518469e-04,1.594395e-04,1.673621e-04,1.756267e-04,1.842456e-04,1.932315e-04,2.025975e-04,2.123570e-04,2.225239e-04,2.331122e-04,2.441365e-04,2.556117e-04,2.675532e-04,2.799767e-04,2.928984e-04,3.063346e-04,3.203026e-04,3.348195e-04,3.499034e-04,3.655723e-04,3.818452e-04,3.987410e-04,4.162795e-04,4.344808e-04,4.533654e-04,4.729544e-04,4.932693e-04,5.143322e-04,5.361656e-04,5.587925e-04,5.822364e-04,6.065215e-04,6.316724e-04,6.577141e-04,6.846723e-04,7.125732e-04,7.414436e-04,7.713107e-04,8.022025e-04,8.341474e-04,8.671744e-04,9.013130e-04,9.365935e-04,9.730466e-04,1.010704e-03,1.049597e-03,1.089758e-03,1.131221e-03,1.174020e-03,1.218188e-03,1.263761e-03,1.310775e-03,1.359266e-03,1.409270e-03,1.460826e-03,1.513972e-03,1.568746e-03,1.625188e-03,1.683339e-03,1.743239e-03,1.804930e-03,1.868453e-03,1.933853e-03,2.001172e-03,2.070455e-03,2.141747e-03,2.215093e-03,2.290540e-03,2.368136e-03,2.447926e-03,2.529961e-03,2.614289e-03,2.700961e-03,2.790026e-03,2.881536e-03,2.975543e-03,3.072100e-03,3.171261e-03,3.273079e-03,3.377609e-03,3.484908e-03,3.595031e-03,3.708035e-03,3.823979e-03,3.942921e-03,4.064919e-03,4.190035e-03,4.318328e-03,4.449861e-03,4.584695e-03,4.722894e-03,4.864520e-03,5.009639e-03,5.158315e-03,5.310615e-03,5.466604e-03,5.626350e-03,5.789922e-03,5.957387e-03,6.128815e-03,6.304276e-03,6.483842e-03,6.667583e-03,6.855572e-03,7.047883e-03,7.244587e-03,7.445761e-03,7.651479e-03,7.861818e-03,8.076852e-03,8.296660e-03,8.521320e-03,8.750909e-03,8.985508e-03,9.225196e-03,9.470053e-03,9.720162e-03,9.975603e-03,1.023646e-02,1.050282e-02,1.077475e-02,1.105236e-02,1.133571e-02,1.162491e-02,1.192003e-02,1.222116e-02,1.252839e-02,1.284180e-02,1.316149e-02,1.348755e-02,1.382006e-02,1.415912e-02,1.450482e-02,1.485724e-02,1.521649e-02,1.558265e-02,1.595581e-02,1.633608e-02,1.672355e-02,1.711830e-02,1.752044e-02,1.793007e-02,1.834727e-02,1.877215e-02,1.920480e-02,1.964533e-02,2.009382e-02,2.055038e-02,2.101512e-02,2.148812e-02,2.196948e-02,2.245932e-02,2.295773e-02,2.346481e-02,2.398066e-02,2.450539e-02,2.503910e-02,2.558189e-02,2.613387e-02,2.669513e-02,2.726579e-02,2.784595e-02,2.843571e-02,2.903517e-02,2.964445e-02,3.026365e-02,3.089287e-02,3.153222e-02,3.218181e-02,3.284175e-02,3.351213e-02,3.419308e-02,3.488469e-02,3.558707e-02,3.630034e-02,3.702459e-02,3.775994e-02,3.850650e-02,3.926437e-02,4.003367e-02,4.081449e-02,4.160696e-02,4.241118e-02,4.322726e-02,4.405531e-02,4.489543e-02,4.574775e-02,4.661235e-02,4.748937e-02,4.837890e-02,4.928106e-02,5.019595e-02,5.112369e-02,5.206438e-02,5.301814e-02,5.398507e-02,5.496528e-02,5.595889e-02,5.696600e-02,5.798672e-02,5.902116e-02,6.006943e-02,6.113163e-02,6.220789e-02,6.329830e-02,6.440298e-02,6.552203e-02,6.665557e-02,6.780369e-02,6.896651e-02,7.014414e-02,7.133668e-02,7.254424e-02,7.376694e-02,7.500486e-02,7.625813e-02,7.752684e-02,7.881111e-02,8.011104e-02,8.142674e-02,8.275830e-02,8.410585e-02,8.546947e-02,8.684928e-02,8.824537e-02,8.965786e-02,9.108684e-02,9.253242e-02,9.399470e-02,9.547379e-02,9.696978e-02,9.848277e-02,1.000129e-01,1.015602e-01,1.031248e-01,1.047068e-01,1.063063e-01,1.079235e-01,1.095583e-01,1.112109e-01,1.128815e-01,1.145700e-01,1.162766e-01,1.180014e-01,1.197445e-01,1.215059e-01,1.232858e-01,1.250843e-01,1.269014e-01,1.287373e-01,1.305920e-01,1.324657e-01,1.343583e-01,1.362701e-01,1.382011e-01,1.401513e-01,1.421210e-01,1.441100e-01,1.461187e-01,1.481470e-01,1.501949e-01,1.522627e-01,1.543504e-01,1.564581e-01,1.585858e-01,1.607336e-01,1.629017e-01,1.650900e-01,1.672987e-01,1.695279e-01,1.717776e-01,1.740480e-01,1.763390e-01,1.786507e-01,1.809833e-01,1.833369e-01,1.857114e-01,1.881069e-01,1.905236e-01,1.929615e-01,1.954207e-01,1.979012e-01,2.004031e-01,2.029265e-01,2.054714e-01,2.080379e-01,2.106261e-01,2.132361e-01,2.158679e-01,2.185215e-01,2.211970e-01,2.238946e-01,2.266142e-01,2.293559e-01,2.321197e-01,2.349058e-01,2.377142e-01,2.405449e-01,2.433980e-01,2.462736e-01,2.491716e-01,2.520922e-01,2.550354e-01,2.580013e-01,2.609898e-01,2.640011e-01,2.670353e-01,2.700922e-01,2.731721e-01,2.762748e-01,2.794006e-01,2.825494e-01,2.857213e-01,2.889162e-01,2.921343e-01,2.953756e-01,2.986401e-01,3.019279e-01,3.052390e-01,3.085734e-01,3.119312e-01,3.153124e-01,3.187170e-01,3.221451e-01,3.255967e-01,3.290718e-01,3.325704e-01,3.360927e-01,3.396385e-01,3.432080e-01,3.468012e-01,3.504180e-01,3.540586e-01,3.577228e-01,3.614109e-01,3.651227e-01,3.688583e-01,3.726177e-01,3.764009e-01,3.802080e-01,3.840389e-01,3.878937e-01,3.917724e-01,3.956749e-01,3.996014e-01,4.035518e-01,4.075262e-01,4.115244e-01,4.155466e-01,4.195928e-01,4.236629e-01,4.277570e-01,4.318751e-01,4.360171e-01,4.401831e-01,4.443730e-01,4.485869e-01,4.528248e-01,4.570867e-01,4.613725e-01,4.656823e-01,4.700161e-01,4.743737e-01,4.787554e-01,4.831609e-01,4.875904e-01,4.920439e-01,4.965212e-01,5.010224e-01,5.055475e-01,5.100965e-01,5.146693e-01,5.192659e-01,5.238864e-01,5.285307e-01,5.331988e-01,5.378907e-01,5.426063e-01,5.473456e-01,5.521086e-01,5.568954e-01,5.617058e-01,5.665398e-01,5.713974e-01,5.762787e-01,5.811834e-01,5.861118e-01,5.910636e-01,5.960389e-01,6.010376e-01,6.060598e-01,6.111053e-01,6.161742e-01,6.212664e-01,6.263819e-01,6.315206e-01,6.366826e-01,6.418677e-01,6.470759e-01,6.523072e-01,6.575616e-01,6.628390e-01,6.681394e-01,6.734627e-01,6.788089e-01,6.841779e-01,6.895697e-01,6.949843e-01,7.004216e-01,7.058816e-01,7.113641e-01,7.168693e-01,7.223969e-01,7.279470e-01,7.335195e-01,7.391144e-01,7.447316e-01,7.503710e-01,7.560327e-01,7.617165e-01,7.674224e-01,7.731503e-01,7.789002e-01,7.846721e-01,7.904658e-01,7.962813e-01,8.021185e-01,8.079775e-01,8.138580e-01,8.197601e-01,8.256838e-01,8.316288e-01,8.375952e-01,8.435830e-01,8.495920e-01,8.556221e-01,8.616734e-01,8.677457e-01,8.738390e-01,8.799532e-01,8.860883e-01,8.922441e-01,8.984206e-01,9.046177e-01,9.108354e-01,9.170736e-01,9.233322e-01,9.296111e-01,9.359103e-01,9.422297e-01,9.485692e-01,9.549287e-01,9.613082e-01,9.677076e-01,9.741267e-01,9.805657e-01,9.870242e-01,9.935024e-01];

var u = [1.800649e-01,1.801201e-01,1.801766e-01,1.802338e-01,1.802917e-01,1.803504e-01,1.804099e-01,1.804701e-01,1.805310e-01,1.805928e-01,1.806553e-01,1.807186e-01,1.807827e-01,1.808476e-01,1.809133e-01,1.809799e-01,1.810473e-01,1.811155e-01,1.811845e-01,1.812545e-01,1.813252e-01,1.813969e-01,1.814694e-01,1.815428e-01,1.816171e-01,1.816923e-01,1.817683e-01,1.818454e-01,1.819233e-01,1.820021e-01,1.820819e-01,1.821627e-01,1.822443e-01,1.823270e-01,1.824106e-01,1.824952e-01,1.825807e-01,1.826672e-01,1.827548e-01,1.828433e-01,1.829328e-01,1.830233e-01,1.831149e-01,1.832075e-01,1.833011e-01,1.833957e-01,1.834914e-01,1.835881e-01,1.836859e-01,1.837847e-01,1.838846e-01,1.839856e-01,1.840876e-01,1.841907e-01,1.842949e-01,1.844002e-01,1.845066e-01,1.846141e-01,1.847226e-01,1.848323e-01,1.849431e-01,1.850550e-01,1.851681e-01,1.852822e-01,1.853975e-01,1.855139e-01,1.856315e-01,1.857502e-01,1.858700e-01,1.859909e-01,1.861131e-01,1.862363e-01,1.863607e-01,1.864863e-01,1.866130e-01,1.867409e-01,1.868700e-01,1.870002e-01,1.871316e-01,1.872641e-01,1.873978e-01,1.875327e-01,1.876687e-01,1.878060e-01,1.879443e-01,1.880839e-01,1.882247e-01,1.883666e-01,1.885097e-01,1.886539e-01,1.887994e-01,1.889460e-01,1.890938e-01,1.892428e-01,1.893929e-01,1.895443e-01,1.896968e-01,1.898504e-01,1.900053e-01,1.901613e-01,1.903185e-01,1.904769e-01,1.906364e-01,1.907971e-01,1.909590e-01,1.911220e-01,1.912862e-01,1.914516e-01,1.916181e-01,1.917858e-01,1.919546e-01,1.921246e-01,1.922958e-01,1.924680e-01,1.926415e-01,1.928161e-01,1.929918e-01,1.931687e-01,1.933467e-01,1.935258e-01,1.937061e-01,1.938875e-01,1.940700e-01,1.942536e-01,1.944384e-01,1.946242e-01,1.948112e-01,1.949993e-01,1.951885e-01,1.953788e-01,1.955702e-01,1.957626e-01,1.959562e-01,1.961509e-01,1.963466e-01,1.965434e-01,1.967413e-01,1.969403e-01,1.971403e-01,1.973414e-01,1.975435e-01,1.977467e-01,1.979509e-01,1.981562e-01,1.983625e-01,1.985699e-01,1.987783e-01,1.989877e-01,1.991981e-01,1.994095e-01,1.996220e-01,1.998354e-01,2.000499e-01,2.002654e-01,2.004818e-01,2.006992e-01,2.009177e-01,2.011371e-01,2.013574e-01,2.015788e-01,2.018011e-01,2.020243e-01,2.022485e-01,2.024737e-01,2.026998e-01,2.029268e-01,2.031548e-01,2.033837e-01,2.036135e-01,2.038442e-01,2.040759e-01,2.043084e-01,2.045419e-01,2.047762e-01,2.050115e-01,2.052476e-01,2.054846e-01,2.057225e-01,2.059612e-01,2.062009e-01,2.064413e-01,2.066827e-01,2.069248e-01,2.071679e-01,2.074117e-01,2.076564e-01,2.079020e-01,2.081483e-01,2.083955e-01,2.086435e-01,2.088923e-01,2.091419e-01,2.093923e-01,2.096435e-01,2.098954e-01,2.101482e-01,2.104017e-01,2.106560e-01,2.109111e-01,2.111670e-01,2.114236e-01,2.116809e-01,2.119390e-01,2.121978e-01,2.124574e-01,2.127177e-01,2.129787e-01,2.132405e-01,2.135029e-01,2.137661e-01,2.140300e-01,2.142946e-01,2.145599e-01,2.148258e-01,2.150925e-01,2.153599e-01,2.156279e-01,2.158966e-01,2.161659e-01,2.164359e-01,2.167066e-01,2.169779e-01,2.172499e-01,2.175225e-01,2.177958e-01,2.180697e-01,2.183442e-01,2.186194e-01,2.188951e-01,2.191715e-01,2.194485e-01,2.197261e-01,2.200043e-01,2.202831e-01,2.205625e-01,2.208424e-01,2.211230e-01,2.214041e-01,2.216858e-01,2.219681e-01,2.222509e-01,2.225343e-01,2.228183e-01,2.231028e-01,2.233878e-01,2.236734e-01,2.239595e-01,2.242462e-01,2.245334e-01,2.248211e-01,2.251093e-01,2.253981e-01,2.256873e-01,2.259771e-01,2.262674e-01,2.265581e-01,2.268494e-01,2.271412e-01,2.274334e-01,2.277261e-01,2.280193e-01,2.283130e-01,2.286072e-01,2.289018e-01,2.291969e-01,2.294924e-01,2.297884e-01,2.300848e-01,2.303817e-01,2.306791e-01,2.309768e-01,2.312750e-01,2.315737e-01,2.318727e-01,2.321722e-01,2.324721e-01,2.327724e-01,2.330732e-01,2.333743e-01,2.336758e-01,2.339778e-01,2.342801e-01,2.345829e-01,2.348860e-01,2.351895e-01,2.354934e-01,2.357976e-01,2.361023e-01,2.364073e-01,2.367127e-01,2.370184e-01,2.373245e-01,2.376310e-01,2.379378e-01,2.382450e-01,2.385525e-01,2.388603e-01,2.391685e-01,2.394771e-01,2.397859e-01,2.400951e-01,2.404047e-01,2.407145e-01,2.410247e-01,2.413352e-01,2.416460e-01,2.419571e-01,2.422685e-01,2.425802e-01,2.428922e-01,2.432045e-01,2.435171e-01,2.438300e-01,2.441432e-01,2.444567e-01,2.447704e-01,2.450844e-01,2.453987e-01,2.457133e-01,2.460282e-01,2.463433e-01,2.466587e-01,2.469743e-01,2.472902e-01,2.476063e-01,2.479227e-01,2.482394e-01,2.485563e-01,2.488734e-01,2.491908e-01,2.495084e-01,2.498262e-01,2.501443e-01,2.504626e-01,2.507811e-01,2.510999e-01,2.514189e-01,2.517380e-01,2.520574e-01,2.523771e-01,2.526969e-01,2.530169e-01,2.533372e-01,2.536576e-01,2.539782e-01,2.542990e-01,2.546201e-01,2.549413e-01,2.552627e-01,2.555843e-01,2.559060e-01,2.562280e-01,2.565501e-01,2.568724e-01,2.571949e-01,2.575175e-01,2.578403e-01,2.581633e-01,2.584865e-01,2.588098e-01,2.591332e-01,2.594568e-01,2.597806e-01,2.601045e-01,2.604286e-01,2.607528e-01,2.610772e-01,2.614017e-01,2.617263e-01,2.620511e-01,2.623760e-01,2.627010e-01,2.630262e-01,2.633515e-01,2.636769e-01,2.640024e-01,2.643281e-01,2.646539e-01,2.649798e-01,2.653058e-01,2.656319e-01,2.659582e-01,2.662845e-01,2.666110e-01,2.669375e-01,2.672642e-01,2.675910e-01,2.679178e-01,2.682448e-01,2.685718e-01,2.688990e-01,2.692262e-01,2.695535e-01,2.698809e-01,2.702084e-01,2.705359e-01,2.708636e-01,2.711913e-01,2.715191e-01,2.718470e-01,2.721749e-01,2.725029e-01,2.728310e-01,2.731591e-01,2.734873e-01,2.738156e-01,2.741439e-01,2.744723e-01,2.748008e-01,2.751293e-01,2.754578e-01,2.757864e-01,2.761151e-01,2.764438e-01,2.767725e-01,2.771013e-01,2.774302e-01,2.777590e-01,2.780879e-01,2.784169e-01,2.787459e-01,2.790749e-01,2.794040e-01,2.797330e-01,2.800621e-01,2.803913e-01,2.807204e-01,2.810496e-01,2.813788e-01,2.817081e-01,2.820373e-01,2.823666e-01,2.826959e-01,2.830252e-01,2.833545e-01,2.836838e-01,2.840131e-01,2.843425e-01,2.846718e-01,2.850012e-01,2.853305e-01,2.856599e-01,2.859892e-01,2.863186e-01,2.866479e-01,2.869773e-01,2.873066e-01,2.876359e-01,2.879653e-01,2.882946e-01,2.886239e-01,2.889532e-01,2.892825e-01,2.896117e-01,2.899410e-01,2.902702e-01,2.905994e-01,2.909286e-01,2.912578e-01,2.915869e-01,2.919160e-01,2.922451e-01,2.925742e-01,2.929032e-01,2.932322e-01,2.935612e-01,2.938901e-01,2.942190e-01,2.945479e-01,2.948767e-01,2.952055e-01,2.955343e-01,2.958630e-01,2.961916e-01,2.965203e-01,2.968489e-01,2.971774e-01,2.975059e-01,2.978343e-01,2.981627e-01,2.984911e-01,2.988194e-01,2.991476e-01,2.994758e-01,2.998039e-01,3.001320e-01,3.004600e-01,3.007880e-01,3.011159e-01,3.014437e-01,3.017715e-01,3.020992e-01,3.024269e-01,3.027545e-01,3.030820e-01,3.034095e-01,3.037368e-01,3.040642e-01,3.043914e-01,3.047186e-01,3.050457e-01,3.053727e-01,3.056997e-01,3.060266e-01,3.063534e-01,3.066801e-01,3.070067e-01,3.073333e-01,3.076598e-01,3.079862e-01,3.083125e-01,3.086387e-01,3.089649e-01,3.092910e-01,3.096170e-01,3.099429e-01,3.102687e-01,3.105944e-01,3.109200e-01,3.112455e-01,3.115710e-01,3.118963e-01,3.122216e-01,3.125468e-01,3.128718e-01,3.131968e-01,3.135217e-01,3.138464e-01,3.141711e-01,3.144957e-01,3.148202e-01,3.151445e-01,3.154688e-01,3.157930e-01,3.161170e-01,3.164410e-01,3.167648e-01,3.170886e-01,3.174122e-01,3.177357e-01,3.180592e-01,3.183825e-01,3.187057e-01,3.190287e-01,3.193517e-01,3.196746e-01,3.199973e-01,3.203200e-01,3.206425e-01,3.209649e-01,3.212871e-01,3.216093e-01,3.219313e-01,3.222533e-01,3.225751e-01,3.228968e-01,3.232183e-01,3.235398e-01,3.238611e-01,3.241823e-01,3.245033e-01,3.248243e-01,3.251451e-01,3.254658e-01,3.257863e-01,3.261068e-01,3.264271e-01,3.267472e-01,3.270673e-01,3.273872e-01,3.277070e-01,3.280266e-01,3.283461e-01,3.286655e-01,3.289848e-01,3.293039e-01,3.296229e-01,3.299417e-01,3.302604e-01,3.305790e-01,3.308974e-01,3.312157e-01,3.315338e-01,3.318518e-01,3.321697e-01,3.324874e-01,3.328050e-01,3.331225e-01,3.334398e-01,3.337569e-01,3.340739e-01,3.343908e-01,3.347075e-01,3.350241e-01,3.353405e-01,3.356568e-01,3.359730e-01,3.362889e-01,3.366048e-01,3.369205e-01];
var v = [2.635235e-01,2.637498e-01,2.639804e-01,2.642130e-01,2.644474e-01,2.646839e-01,2.649223e-01,2.651625e-01,2.654047e-01,2.656488e-01,2.658948e-01,2.661427e-01,2.663924e-01,2.666439e-01,2.668973e-01,2.671525e-01,2.674095e-01,2.676683e-01,2.679289e-01,2.681913e-01,2.684553e-01,2.687211e-01,2.689886e-01,2.692578e-01,2.695286e-01,2.698011e-01,2.700753e-01,2.703510e-01,2.706284e-01,2.709073e-01,2.711877e-01,2.714697e-01,2.717532e-01,2.720382e-01,2.723247e-01,2.726126e-01,2.729019e-01,2.731927e-01,2.734848e-01,2.737783e-01,2.740731e-01,2.743692e-01,2.746666e-01,2.749652e-01,2.752651e-01,2.755662e-01,2.758685e-01,2.761720e-01,2.764766e-01,2.767824e-01,2.770892e-01,2.773971e-01,2.777060e-01,2.780159e-01,2.783269e-01,2.786388e-01,2.789516e-01,2.792653e-01,2.795800e-01,2.798955e-01,2.802118e-01,2.805290e-01,2.808469e-01,2.811656e-01,2.814851e-01,2.818052e-01,2.821260e-01,2.824475e-01,2.827696e-01,2.830924e-01,2.834157e-01,2.837395e-01,2.840639e-01,2.843888e-01,2.847142e-01,2.850401e-01,2.853663e-01,2.856930e-01,2.860201e-01,2.863475e-01,2.866753e-01,2.870033e-01,2.873317e-01,2.876603e-01,2.879891e-01,2.883182e-01,2.886474e-01,2.889768e-01,2.893064e-01,2.896361e-01,2.899659e-01,2.902957e-01,2.906256e-01,2.909555e-01,2.912855e-01,2.916154e-01,2.919453e-01,2.922752e-01,2.926049e-01,2.929346e-01,2.932642e-01,2.935936e-01,2.939228e-01,2.942519e-01,2.945808e-01,2.949094e-01,2.952379e-01,2.955660e-01,2.958939e-01,2.962215e-01,2.965488e-01,2.968758e-01,2.972024e-01,2.975286e-01,2.978545e-01,2.981799e-01,2.985050e-01,2.988296e-01,2.991538e-01,2.994775e-01,2.998007e-01,3.001234e-01,3.004456e-01,3.007673e-01,3.010885e-01,3.014090e-01,3.017291e-01,3.020485e-01,3.023673e-01,3.026855e-01,3.030031e-01,3.033201e-01,3.036364e-01,3.039520e-01,3.042670e-01,3.045813e-01,3.048948e-01,3.052077e-01,3.055198e-01,3.058312e-01,3.061419e-01,3.064518e-01,3.067609e-01,3.070692e-01,3.073768e-01,3.076836e-01,3.079895e-01,3.082946e-01,3.085990e-01,3.089024e-01,3.092050e-01,3.095068e-01,3.098077e-01,3.101078e-01,3.104069e-01,3.107052e-01,3.110026e-01,3.112990e-01,3.115946e-01,3.118892e-01,3.121830e-01,3.124757e-01,3.127676e-01,3.130585e-01,3.133485e-01,3.136375e-01,3.139255e-01,3.142126e-01,3.144987e-01,3.147838e-01,3.150680e-01,3.153511e-01,3.156333e-01,3.159144e-01,3.161946e-01,3.164737e-01,3.167519e-01,3.170290e-01,3.173051e-01,3.175802e-01,3.178542e-01,3.181272e-01,3.183992e-01,3.186702e-01,3.189401e-01,3.192089e-01,3.194768e-01,3.197435e-01,3.200092e-01,3.202739e-01,3.205375e-01,3.208001e-01,3.210615e-01,3.213219e-01,3.215813e-01,3.218396e-01,3.220968e-01,3.223529e-01,3.226080e-01,3.228620e-01,3.231149e-01,3.233668e-01,3.236176e-01,3.238672e-01,3.241159e-01,3.243634e-01,3.246098e-01,3.248552e-01,3.250995e-01,3.253427e-01,3.255848e-01,3.258259e-01,3.260658e-01,3.263047e-01,3.265425e-01,3.267792e-01,3.270148e-01,3.272493e-01,3.274828e-01,3.277152e-01,3.279464e-01,3.281767e-01,3.284058e-01,3.286338e-01,3.288608e-01,3.290867e-01,3.293115e-01,3.295352e-01,3.297579e-01,3.299795e-01,3.302000e-01,3.304194e-01,3.306378e-01,3.308550e-01,3.310713e-01,3.312864e-01,3.315005e-01,3.317135e-01,3.319255e-01,3.321364e-01,3.323462e-01,3.325550e-01,3.327627e-01,3.329693e-01,3.331749e-01,3.333795e-01,3.335830e-01,3.337854e-01,3.339868e-01,3.341872e-01,3.343865e-01,3.345848e-01,3.347820e-01,3.349782e-01,3.351734e-01,3.353675e-01,3.355606e-01,3.357527e-01,3.359438e-01,3.361338e-01,3.363228e-01,3.365108e-01,3.366978e-01,3.368837e-01,3.370687e-01,3.372526e-01,3.374355e-01,3.376175e-01,3.377984e-01,3.379783e-01,3.381572e-01,3.383352e-01,3.385121e-01,3.386881e-01,3.388631e-01,3.390371e-01,3.392101e-01,3.393821e-01,3.395532e-01,3.397233e-01,3.398924e-01,3.400606e-01,3.402277e-01,3.403940e-01,3.405593e-01,3.407236e-01,3.408870e-01,3.410494e-01,3.412109e-01,3.413714e-01,3.415310e-01,3.416896e-01,3.418474e-01,3.420042e-01,3.421600e-01,3.423150e-01,3.424690e-01,3.426221e-01,3.427743e-01,3.429256e-01,3.430759e-01,3.432254e-01,3.433740e-01,3.435216e-01,3.436684e-01,3.438142e-01,3.439592e-01,3.441033e-01,3.442465e-01,3.443888e-01,3.445303e-01,3.446709e-01,3.448106e-01,3.449494e-01,3.450874e-01,3.452245e-01,3.453607e-01,3.454961e-01,3.456307e-01,3.457643e-01,3.458972e-01,3.460292e-01,3.461603e-01,3.462907e-01,3.464202e-01,3.465488e-01,3.466767e-01,3.468037e-01,3.469299e-01,3.470552e-01,3.471798e-01,3.473036e-01,3.474265e-01,3.475486e-01,3.476700e-01,3.477905e-01,3.479103e-01,3.480292e-01,3.481474e-01,3.482648e-01,3.483814e-01,3.484972e-01,3.486123e-01,3.487265e-01,3.488400e-01,3.489528e-01,3.490648e-01,3.491760e-01,3.492865e-01,3.493962e-01,3.495051e-01,3.496133e-01,3.497208e-01,3.498276e-01,3.499336e-01,3.500388e-01,3.501433e-01,3.502472e-01,3.503502e-01,3.504526e-01,3.505542e-01,3.506552e-01,3.507554e-01,3.508549e-01,3.509537e-01,3.510518e-01,3.511492e-01,3.512459e-01,3.513419e-01,3.514373e-01,3.515319e-01,3.516259e-01,3.517191e-01,3.518117e-01,3.519037e-01,3.519949e-01,3.520855e-01,3.521754e-01,3.522647e-01,3.523533e-01,3.524413e-01,3.525286e-01,3.526152e-01,3.527012e-01,3.527866e-01,3.528713e-01,3.529553e-01,3.530388e-01,3.531216e-01,3.532038e-01,3.532853e-01,3.533663e-01,3.534466e-01,3.535263e-01,3.536054e-01,3.536839e-01,3.537617e-01,3.538390e-01,3.539157e-01,3.539917e-01,3.540672e-01,3.541421e-01,3.542164e-01,3.542901e-01,3.543632e-01,3.544357e-01,3.545076e-01,3.545790e-01,3.546498e-01,3.547201e-01,3.547897e-01,3.548588e-01,3.549274e-01,3.549954e-01,3.550628e-01,3.551297e-01,3.551960e-01,3.552617e-01,3.553270e-01,3.553917e-01,3.554558e-01,3.555194e-01,3.555825e-01,3.556450e-01,3.557071e-01,3.557685e-01,3.558295e-01,3.558900e-01,3.559499e-01,3.560093e-01,3.560682e-01,3.561266e-01,3.561845e-01,3.562419e-01,3.562987e-01,3.563551e-01,3.564110e-01,3.564664e-01,3.565213e-01,3.565757e-01,3.566296e-01,3.566830e-01,3.567360e-01,3.567884e-01,3.568404e-01,3.568920e-01,3.569430e-01,3.569936e-01,3.570437e-01,3.570934e-01,3.571426e-01,3.571913e-01,3.572396e-01,3.572874e-01,3.573348e-01,3.573817e-01,3.574281e-01,3.574742e-01,3.575198e-01,3.575649e-01,3.576096e-01,3.576539e-01,3.576977e-01,3.577411e-01,3.577841e-01,3.578267e-01,3.578688e-01,3.579105e-01,3.579518e-01,3.579927e-01,3.580332e-01,3.580732e-01,3.581129e-01,3.581521e-01,3.581909e-01,3.582294e-01,3.582674e-01,3.583050e-01,3.583423e-01,3.583791e-01,3.584156e-01,3.584516e-01,3.584873e-01,3.585226e-01,3.585575e-01,3.585920e-01,3.586261e-01,3.586599e-01,3.586933e-01,3.587263e-01,3.587590e-01,3.587912e-01,3.588232e-01,3.588547e-01,3.588859e-01,3.589167e-01,3.589472e-01,3.589773e-01,3.590071e-01,3.590365e-01,3.590656e-01,3.590943e-01,3.591226e-01,3.591507e-01,3.591783e-01,3.592057e-01,3.592327e-01,3.592594e-01,3.592857e-01,3.593117e-01,3.593374e-01,3.593627e-01,3.593877e-01,3.594124e-01,3.594368e-01,3.594608e-01,3.594846e-01,3.595080e-01,3.595311e-01,3.595539e-01,3.595763e-01,3.595985e-01,3.596204e-01,3.596419e-01,3.596632e-01,3.596841e-01,3.597047e-01,3.597251e-01,3.597451e-01,3.597649e-01,3.597844e-01,3.598035e-01,3.598224e-01,3.598410e-01,3.598593e-01,3.598773e-01,3.598950e-01,3.599125e-01,3.599297e-01,3.599466e-01,3.599632e-01,3.599795e-01,3.599956e-01,3.600114e-01,3.600269e-01,3.600422e-01,3.600572e-01,3.600719e-01,3.600864e-01,3.601006e-01,3.601145e-01,3.601282e-01,3.601417e-01,3.601548e-01,3.601678e-01,3.601804e-01,3.601928e-01,3.602050e-01,3.602169e-01,3.602286e-01,3.602400e-01,3.602512e-01,3.602622e-01,3.602729e-01,3.602833e-01,3.602936e-01,3.603036e-01,3.603133e-01,3.603229e-01,3.603322e-01,3.603412e-01,3.603501e-01,3.603587e-01,3.603671e-01,3.603752e-01,3.603832e-01,3.603909e-01,3.603984e-01,3.604057e-01,3.604127e-01,3.604196e-01,3.604262e-01,3.604326e-01,3.604388e-01,3.604448e-01,3.604506e-01,3.604562e-01,3.604615e-01,3.604667e-01,3.604717e-01,3.604764e-01,3.604810e-01,3.604854e-01,3.604895e-01,3.604935e-01,3.604972e-01,3.605008e-01,3.605042e-01,3.605074e-01,3.605104e-01];

Uprime = 1.4396e09;
Vprime = 1.5996e09;
Wprime = 1.3991e09;
Rprime = 4.4382e09;

var sl = [4.108104e00,4.091070e00,4.073590e00,4.055842e00,4.037833e00,4.019572e00,4.001067e00,3.982324e00,3.963353e00,3.944161e00,3.924755e00,3.905145e00,3.885337e00,3.865340e00,3.845162e00,3.824810e00,3.804294e00,3.783620e00,3.762796e00,3.741831e00,3.720732e00,3.699507e00,3.678163e00,3.656708e00,3.635150e00,3.613496e00,3.591753e00,3.569929e00,3.548030e00,3.526064e00,3.504038e00,3.481958e00,3.459831e00,3.437664e00,3.415464e00,3.393236e00,3.370987e00,3.348722e00,3.326449e00,3.304173e00,3.281898e00,3.259632e00,3.237379e00,3.215145e00,3.192935e00,3.170754e00,3.148607e00,3.126498e00,3.104432e00,3.082413e00,3.060447e00,3.038537e00,3.016686e00,2.994900e00,2.973182e00,2.951535e00,2.929963e00,2.908470e00,2.887058e00,2.865731e00,2.844492e00,2.823344e00,2.802289e00,2.781330e00,2.760470e00,2.739710e00,2.719054e00,2.698504e00,2.678061e00,2.657728e00,2.637506e00,2.617397e00,2.597403e00,2.577526e00,2.557766e00,2.538125e00,2.518605e00,2.499207e00,2.479932e00,2.460780e00,2.441754e00,2.422852e00,2.404078e00,2.385430e00,2.366910e00,2.348519e00,2.330256e00,2.312123e00,2.294120e00,2.276246e00,2.258503e00,2.240890e00,2.223407e00,2.206055e00,2.188834e00,2.171744e00,2.154784e00,2.137954e00,2.121255e00,2.104686e00,2.088247e00,2.071938e00,2.055758e00,2.039706e00,2.023784e00,2.007989e00,1.992322e00,1.976783e00,1.961370e00,1.946083e00,1.930922e00,1.915886e00,1.900974e00,1.886186e00,1.871521e00,1.856979e00,1.842559e00,1.828259e00,1.814080e00,1.800021e00,1.786080e00,1.772258e00,1.758553e00,1.744964e00,1.731492e00,1.718134e00,1.704890e00,1.691760e00,1.678742e00,1.665835e00,1.653040e00,1.640354e00,1.627777e00,1.615309e00,1.602948e00,1.590693e00,1.578544e00,1.566500e00,1.554559e00,1.542722e00,1.530986e00,1.519352e00,1.507818e00,1.496383e00,1.485047e00,1.473809e00,1.462668e00,1.451622e00,1.440672e00,1.429815e00,1.419052e00,1.408382e00,1.397803e00,1.387315e00,1.376916e00,1.366607e00,1.356386e00,1.346253e00,1.336206e00,1.326244e00,1.316368e00,1.306575e00,1.296866e00,1.287239e00,1.277694e00,1.268230e00,1.258846e00,1.249540e00,1.240314e00,1.231165e00,1.222093e00,1.213097e00,1.204177e00,1.195331e00,1.186560e00,1.177861e00,1.169235e00,1.160681e00,1.152197e00,1.143784e00,1.135440e00,1.127166e00,1.118959e00,1.110820e00,1.102748e00,1.094742e00,1.086802e00,1.078926e00,1.071115e00,1.063367e00,1.055682e00,1.048059e00,1.040498e00,1.032998e00,1.025558e00,1.018178e00,1.010857e00,1.003595e00,9.963906e-01,9.892438e-01,9.821538e-01,9.751201e-01,9.681422e-01,9.612194e-01,9.543511e-01,9.475370e-01,9.407763e-01,9.340687e-01,9.274134e-01,9.208102e-01,9.142583e-01,9.077573e-01,9.013067e-01,8.949061e-01,8.885548e-01,8.822525e-01,8.759986e-01,8.697926e-01,8.636342e-01,8.575228e-01,8.514579e-01,8.454392e-01,8.394661e-01,8.335382e-01,8.276551e-01,8.218163e-01,8.160215e-01,8.102701e-01,8.045618e-01,7.988962e-01,7.932728e-01,7.876912e-01,7.821511e-01,7.766520e-01,7.711935e-01,7.657753e-01,7.603970e-01,7.550582e-01,7.497586e-01,7.444976e-01,7.392751e-01,7.340906e-01,7.289438e-01,7.238343e-01,7.187618e-01,7.137260e-01,7.087264e-01,7.037627e-01,6.988347e-01,6.939420e-01,6.890843e-01,6.842612e-01,6.794725e-01,6.747178e-01,6.699967e-01,6.653091e-01,6.606546e-01,6.560329e-01,6.514437e-01,6.468867e-01,6.423617e-01,6.378683e-01,6.334062e-01,6.289752e-01,6.245750e-01,6.202054e-01,6.158660e-01,6.115566e-01,6.072769e-01,6.030267e-01,5.988058e-01,5.946137e-01,5.904504e-01,5.863155e-01,5.822089e-01,5.781302e-01,5.740792e-01,5.700558e-01,5.660595e-01,5.620903e-01,5.581479e-01,5.542321e-01,5.503426e-01,5.464792e-01,5.426417e-01,5.388298e-01,5.350435e-01,5.312824e-01,5.275463e-01,5.238350e-01,5.201484e-01,5.164862e-01,5.128483e-01,5.092343e-01,5.056442e-01,5.020777e-01,4.985346e-01,4.950148e-01,4.915180e-01,4.880441e-01,4.845929e-01,4.811642e-01,4.777578e-01,4.743735e-01,4.710112e-01,4.676707e-01,4.643519e-01,4.610544e-01,4.577783e-01,4.545232e-01,4.512891e-01,4.480758e-01,4.448831e-01,4.417108e-01,4.385588e-01,4.354270e-01,4.323151e-01,4.292231e-01,4.261508e-01,4.230979e-01,4.200645e-01,4.170502e-01,4.140551e-01,4.110788e-01,4.081214e-01,4.051826e-01,4.022623e-01,3.993603e-01,3.964766e-01,3.936110e-01,3.907634e-01,3.879335e-01,3.851214e-01,3.823268e-01,3.795496e-01,3.767897e-01,3.740470e-01,3.713213e-01,3.686126e-01,3.659206e-01,3.632453e-01,3.605865e-01,3.579442e-01,3.553182e-01,3.527084e-01,3.501146e-01,3.475369e-01,3.449749e-01,3.424287e-01,3.398981e-01,3.373830e-01,3.348832e-01,3.323988e-01,3.299296e-01,3.274754e-01,3.250361e-01,3.226118e-01,3.202021e-01,3.178072e-01,3.154267e-01,3.130607e-01,3.107091e-01,3.083716e-01,3.060484e-01,3.037391e-01,3.014438e-01,2.991624e-01,2.968947e-01,2.946407e-01,2.924002e-01,2.901732e-01,2.879596e-01,2.857593e-01,2.835722e-01,2.813981e-01,2.792371e-01,2.770891e-01,2.749538e-01,2.728313e-01,2.707215e-01,2.686243e-01,2.665396e-01,2.644673e-01,2.624073e-01,2.603595e-01,2.583240e-01,2.563005e-01,2.542890e-01,2.522895e-01,2.503018e-01,2.483258e-01,2.463616e-01,2.444089e-01,2.424679e-01,2.405382e-01,2.386200e-01,2.367130e-01,2.348173e-01,2.329328e-01,2.310593e-01,2.291969e-01,2.273454e-01,2.255048e-01,2.236750e-01,2.218560e-01,2.200476e-01,2.182498e-01,2.164625e-01,2.146857e-01,2.129193e-01,2.111632e-01,2.094173e-01,2.076817e-01,2.059562e-01,2.042408e-01,2.025353e-01,2.008398e-01,1.991542e-01,1.974784e-01,1.958123e-01,1.941559e-01,1.925092e-01,1.908720e-01,1.892443e-01,1.876261e-01,1.860172e-01,1.844177e-01,1.828275e-01,1.812464e-01,1.796746e-01,1.781118e-01,1.765580e-01,1.750132e-01,1.734774e-01,1.719504e-01,1.704323e-01,1.689229e-01,1.674222e-01,1.659302e-01,1.644468e-01,1.629719e-01,1.615055e-01,1.600476e-01,1.585980e-01,1.571568e-01,1.557239e-01,1.542992e-01,1.528827e-01,1.514743e-01,1.500740e-01,1.486818e-01,1.472975e-01,1.459212e-01,1.445528e-01,1.431922e-01,1.418394e-01,1.404944e-01,1.391570e-01,1.378273e-01,1.365053e-01,1.351907e-01,1.338837e-01,1.325842e-01,1.312921e-01,1.300074e-01,1.287300e-01,1.274599e-01,1.261971e-01,1.249414e-01,1.236929e-01,1.224516e-01,1.212173e-01,1.199900e-01,1.187698e-01,1.175565e-01,1.163501e-01,1.151505e-01,1.139578e-01,1.127719e-01,1.115927e-01,1.104203e-01,1.092545e-01,1.080953e-01,1.069427e-01,1.057966e-01,1.046571e-01,1.035240e-01,1.023974e-01,1.012772e-01,1.001633e-01,9.905571e-02,9.795442e-02,9.685938e-02,9.577055e-02,9.468788e-02,9.361135e-02,9.254092e-02,9.147655e-02,9.041821e-02,8.936585e-02,8.831946e-02,8.727899e-02,8.624440e-02,8.521566e-02,8.419275e-02,8.317561e-02,8.216423e-02,8.115856e-02,8.015858e-02,7.916425e-02,7.817553e-02,7.719240e-02,7.621482e-02,7.524276e-02,7.427618e-02,7.331506e-02,7.235937e-02,7.140907e-02,7.046412e-02,6.952451e-02,6.859020e-02,6.766115e-02,6.673734e-02,6.581874e-02,6.490532e-02,6.399704e-02,6.309388e-02,6.219581e-02,6.130279e-02,6.041481e-02,5.953182e-02,5.865381e-02,5.778073e-02,5.691258e-02,5.604930e-02,5.519089e-02,5.433730e-02,5.348851e-02,5.264450e-02,5.180524e-02,5.097069e-02,5.014084e-02,4.931565e-02,4.849509e-02,4.767915e-02,4.686780e-02,4.606100e-02,4.525874e-02,4.446098e-02,4.366771e-02,4.287888e-02,4.209449e-02,4.131450e-02,4.053889e-02,3.976764e-02,3.900071e-02,3.823809e-02,3.747974e-02,3.672566e-02,3.597580e-02,3.523015e-02,3.448868e-02,3.375137e-02,3.301819e-02,3.228913e-02,3.156415e-02,3.084324e-02,3.012637e-02,2.941351e-02,2.870465e-02,2.799977e-02,2.729883e-02,2.660182e-02,2.590872e-02,2.521950e-02,2.453414e-02,2.385262e-02,2.317491e-02,2.250100e-02,2.183087e-02,2.116448e-02,2.050183e-02,1.984289e-02,1.918763e-02,1.853604e-02,1.788810e-02,1.724378e-02,1.660307e-02,1.596595e-02,1.533239e-02,1.470237e-02,1.407588e-02,1.345289e-02,1.283339e-02,1.221735e-02,1.160475e-02,1.099558e-02,1.038982e-02,9.787441e-03,9.188432e-03];
var m = [-2.434213e-01,-2.444348e-01,-2.454837e-01,-2.465580e-01,-2.476576e-01,-2.487827e-01,-2.499333e-01,-2.511096e-01,-2.523116e-01,-2.535394e-01,-2.547930e-01,-2.560725e-01,-2.573779e-01,-2.587095e-01,-2.600671e-01,-2.614509e-01,-2.628609e-01,-2.642972e-01,-2.657598e-01,-2.672488e-01,-2.687643e-01,-2.703063e-01,-2.718748e-01,-2.734700e-01,-2.750918e-01,-2.767403e-01,-2.784156e-01,-2.801176e-01,-2.818466e-01,-2.836023e-01,-2.853851e-01,-2.871948e-01,-2.890314e-01,-2.908952e-01,-2.927860e-01,-2.947040e-01,-2.966491e-01,-2.986213e-01,-3.006209e-01,-3.026476e-01,-3.047017e-01,-3.067831e-01,-3.088918e-01,-3.110279e-01,-3.131914e-01,-3.153824e-01,-3.176008e-01,-3.198467e-01,-3.221201e-01,-3.244211e-01,-3.267497e-01,-3.291058e-01,-3.314895e-01,-3.339009e-01,-3.363400e-01,-3.388067e-01,-3.413012e-01,-3.438234e-01,-3.463733e-01,-3.489511e-01,-3.515566e-01,-3.541900e-01,-3.568512e-01,-3.595402e-01,-3.622572e-01,-3.650021e-01,-3.677749e-01,-3.705757e-01,-3.734045e-01,-3.762613e-01,-3.791461e-01,-3.820590e-01,-3.849999e-01,-3.879690e-01,-3.909662e-01,-3.939916e-01,-3.970451e-01,-4.001269e-01,-4.032369e-01,-4.063752e-01,-4.095417e-01,-4.127367e-01,-4.159599e-01,-4.192116e-01,-4.224917e-01,-4.258003e-01,-4.291373e-01,-4.325029e-01,-4.358971e-01,-4.393198e-01,-4.427712e-01,-4.462514e-01,-4.497602e-01,-4.532978e-01,-4.568642e-01,-4.604595e-01,-4.640837e-01,-4.677368e-01,-4.714190e-01,-4.751302e-01,-4.788705e-01,-4.826400e-01,-4.864387e-01,-4.902666e-01,-4.941240e-01,-4.980107e-01,-5.019268e-01,-5.058725e-01,-5.098478e-01,-5.138527e-01,-5.178874e-01,-5.219518e-01,-5.260461e-01,-5.301704e-01,-5.343246e-01,-5.385090e-01,-5.427235e-01,-5.469684e-01,-5.512435e-01,-5.555491e-01,-5.598852e-01,-5.642519e-01,-5.686494e-01,-5.730776e-01,-5.775367e-01,-5.820268e-01,-5.865481e-01,-5.911005e-01,-5.956843e-01,-6.002994e-01,-6.049461e-01,-6.096245e-01,-6.143346e-01,-6.190766e-01,-6.238506e-01,-6.286567e-01,-6.334951e-01,-6.383658e-01,-6.432691e-01,-6.482050e-01,-6.531737e-01,-6.581753e-01,-6.632100e-01,-6.682779e-01,-6.733792e-01,-6.785139e-01,-6.836823e-01,-6.888845e-01,-6.941207e-01,-6.993911e-01,-7.046957e-01,-7.100348e-01,-7.154085e-01,-7.208170e-01,-7.262605e-01,-7.317391e-01,-7.372531e-01,-7.428026e-01,-7.483879e-01,-7.540090e-01,-7.596662e-01,-7.653597e-01,-7.710897e-01,-7.768564e-01,-7.826600e-01,-7.885006e-01,-7.943787e-01,-8.002942e-01,-8.062475e-01,-8.122387e-01,-8.182682e-01,-8.243361e-01,-8.304426e-01,-8.365880e-01,-8.427726e-01,-8.489965e-01,-8.552601e-01,-8.615635e-01,-8.679070e-01,-8.742910e-01,-8.807155e-01,-8.871809e-01,-8.936875e-01,-9.002356e-01,-9.068253e-01,-9.134570e-01,-9.201310e-01,-9.268475e-01,-9.336069e-01,-9.404093e-01,-9.472553e-01,-9.541449e-01,-9.610785e-01,-9.680565e-01,-9.750792e-01,-9.821468e-01,-9.892596e-01,-9.964181e-01,-1.003623e00,-1.010873e00,-1.018170e00,-1.025515e00,-1.032906e00,-1.040345e00,-1.047832e00,-1.055368e00,-1.062952e00,-1.070585e00,-1.078268e00,-1.086000e00,-1.093783e00,-1.101616e00,-1.109500e00,-1.117436e00,-1.125423e00,-1.133462e00,-1.141554e00,-1.149699e00,-1.157898e00,-1.166150e00,-1.174456e00,-1.182817e00,-1.191233e00,-1.199705e00,-1.208233e00,-1.216817e00,-1.225458e00,-1.234156e00,-1.242913e00,-1.251727e00,-1.260600e00,-1.269533e00,-1.278525e00,-1.287578e00,-1.296691e00,-1.305866e00,-1.315102e00,-1.324401e00,-1.333763e00,-1.343188e00,-1.352676e00,-1.362230e00,-1.371848e00,-1.381532e00,-1.391281e00,-1.401098e00,-1.410982e00,-1.420933e00,-1.430953e00,-1.441043e00,-1.451201e00,-1.461430e00,-1.471730e00,-1.482101e00,-1.492545e00,-1.503061e00,-1.513650e00,-1.524314e00,-1.535052e00,-1.545866e00,-1.556755e00,-1.567722e00,-1.578766e00,-1.589888e00,-1.601089e00,-1.612369e00,-1.623730e00,-1.635172e00,-1.646695e00,-1.658301e00,-1.669991e00,-1.681764e00,-1.693622e00,-1.705566e00,-1.717597e00,-1.729714e00,-1.741920e00,-1.754214e00,-1.766599e00,-1.779073e00,-1.791640e00,-1.804298e00,-1.817050e00,-1.829896e00,-1.842837e00,-1.855873e00,-1.869007e00,-1.882238e00,-1.895568e00,-1.908998e00,-1.922528e00,-1.936160e00,-1.949895e00,-1.963733e00,-1.977675e00,-1.991724e00,-2.005879e00,-2.020142e00,-2.034514e00,-2.048995e00,-2.063588e00,-2.078293e00,-2.093111e00,-2.108043e00,-2.123092e00,-2.138256e00,-2.153539e00,-2.168941e00,-2.184464e00,-2.200108e00,-2.215874e00,-2.231765e00,-2.247782e00,-2.263925e00,-2.280196e00,-2.296596e00,-2.313127e00,-2.329791e00,-2.346587e00,-2.363519e00,-2.380587e00,-2.397793e00,-2.415138e00,-2.432624e00,-2.450251e00,-2.468023e00,-2.485940e00,-2.504004e00,-2.522217e00,-2.540579e00,-2.559094e00,-2.577761e00,-2.596584e00,-2.615564e00,-2.634702e00,-2.654000e00,-2.673461e00,-2.693085e00,-2.712876e00,-2.732833e00,-2.752961e00,-2.773259e00,-2.793731e00,-2.814379e00,-2.835203e00,-2.856207e00,-2.877393e00,-2.898762e00,-2.920316e00,-2.942059e00,-2.963991e00,-2.986115e00,-3.008434e00,-3.030950e00,-3.053665e00,-3.076581e00,-3.099701e00,-3.123027e00,-3.146562e00,-3.170309e00,-3.194269e00,-3.218445e00,-3.242840e00,-3.267457e00,-3.292299e00,-3.317367e00,-3.342666e00,-3.368197e00,-3.393964e00,-3.419970e00,-3.446217e00,-3.472709e00,-3.499449e00,-3.526439e00,-3.553684e00,-3.581186e00,-3.608948e00,-3.636974e00,-3.665268e00,-3.693833e00,-3.722671e00,-3.751788e00,-3.781186e00,-3.810870e00,-3.840843e00,-3.871108e00,-3.901670e00,-3.932533e00,-3.963701e00,-3.995178e00,-4.026967e00,-4.059075e00,-4.091503e00,-4.124258e00,-4.157344e00,-4.190764e00,-4.224524e00,-4.258629e00,-4.293084e00,-4.327892e00,-4.363060e00,-4.398593e00,-4.434495e00,-4.470772e00,-4.507429e00,-4.544472e00,-4.581906e00,-4.619738e00,-4.657972e00,-4.696616e00,-4.735674e00,-4.775154e00,-4.815061e00,-4.855401e00,-4.896182e00,-4.937410e00,-4.979092e00,-5.021235e00,-5.063845e00,-5.106931e00,-5.150499e00,-5.194557e00,-5.239113e00,-5.284174e00,-5.329749e00,-5.375846e00,-5.422472e00,-5.469637e00,-5.517350e00,-5.565618e00,-5.614452e00,-5.663861e00,-5.713853e00,-5.764439e00,-5.815629e00,-5.867433e00,-5.919860e00,-5.972923e00,-6.026631e00,-6.080995e00,-6.136028e00,-6.191740e00,-6.248143e00,-6.305250e00,-6.363072e00,-6.421623e00,-6.480916e00,-6.540964e00,-6.601780e00,-6.663379e00,-6.725774e00,-6.788981e00,-6.853014e00,-6.917889e00,-6.983621e00,-7.050227e00,-7.117723e00,-7.186127e00,-7.255455e00,-7.325725e00,-7.396956e00,-7.469167e00,-7.542376e00,-7.616604e00,-7.691871e00,-7.768197e00,-7.845605e00,-7.924115e00,-8.003751e00,-8.084536e00,-8.166493e00,-8.249648e00,-8.334025e00,-8.419650e00,-8.506550e00,-8.594752e00,-8.684284e00,-8.775175e00,-8.867456e00,-8.961156e00,-9.056308e00,-9.152944e00,-9.251097e00,-9.350803e00,-9.452095e00,-9.555013e00,-9.659592e00,-9.765872e00,-9.873894e00,-9.983699e00,-1.009533e01,-1.020883e01,-1.032425e01,-1.044162e01,-1.056101e01,-1.068247e01,-1.080603e01,-1.093176e01,-1.105972e01,-1.118996e01,-1.132253e01,-1.145751e01,-1.159496e01,-1.173493e01,-1.187751e01,-1.202275e01,-1.217075e01,-1.232156e01,-1.247527e01,-1.263196e01,-1.279173e01,-1.295464e01,-1.312081e01,-1.329032e01,-1.346327e01,-1.363976e01,-1.381991e01,-1.400382e01,-1.419162e01,-1.438342e01,-1.457934e01,-1.477953e01,-1.498411e01,-1.519324e01,-1.540706e01,-1.562572e01,-1.584940e01,-1.607825e01,-1.631247e01,-1.655223e01,-1.679774e01,-1.704919e01,-1.730681e01,-1.757081e01,-1.784144e01,-1.811893e01,-1.840356e01,-1.869560e01,-1.899534e01,-1.930307e01,-1.961912e01,-1.994382e01,-2.027754e01,-2.062064e01,-2.097353e01,-2.133661e01,-2.171034e01,-2.209518e01,-2.249163e01,-2.290022e01,-2.332150e01,-2.375608e01,-2.420458e01,-2.466767e01,-2.514607e01,-2.564056e01,-2.615194e01,-2.668108e01,-2.722892e01,-2.779646e01,-2.838478e01,-2.899502e01,-2.962843e01,-3.028634e01,-3.097018e01,-3.168151e01,-3.242202e01,-3.319352e01,-3.399798e01,-3.483756e01,-3.571458e01,-3.663160e01,-3.759141e01,-3.859704e01,-3.965186e01,-4.075953e01,-4.192412e01,-4.315011e01,-4.444246e01,-4.580670e01,-4.724897e01,-4.877613e01,-5.039590e01,-5.211691e01,-5.394895e01,-5.590309e01,-5.799191e01,-6.022981e01,-6.263330e01,-6.522141e01,-6.801624e01,-7.104353e01,-7.433347e01,-7.792176e01,-8.185084e01,-8.617160e01,-9.094562e01,-9.624808e01,-1.021718e02,-1.088325e02];

var ut = u;
var vt = v;
var tt = m;
// isoTempLinesTable = [T' u' v' m'];
// %save isoTempLinesNewestFine.txt isoTempLinesTable -ascii; % Optionally save file


/*====================================  CCT  ==================================== */

//Second, calculate Correlated Color Temperature (CCT), Tc

//%load ('isoTempLinesNewestFine.mat', 'T', 'ut', 'vt', 'tt'); % If read from previously saved file
//EDITS HERE
//% Interpolate CIE functions to spd increments
// xbar = interp1(wavelength,xbar,wavelength_spd);
// xbar(isnan(xbar)) = 0.0;
// ybar = interp1(wavelength,ybar,wavelength_spd);
// ybar(isnan(ybar)) = 0.0;
// zbar = interp1(wavelength,zbar,wavelength_spd);
// zbar(isnan(zbar)) = 0.0;
// //% Calculate Chromaticity Coordinates
// X = trapz(wavelength_spd,spd.*xbar);
// Y = trapz(wavelength_spd,spd.*ybar);
// Z = trapz(wavelength_spd,spd.*zbar);
var X = 1.0250e13;
var Y = 1.0591e13;
var Z = 1.7105e12;
var x = X/(X+Y+Z);
var y = Y/(X+Y+Z);
var u = 4*x/(-2*x+12*y+3);
var v = 6*y/(-2*x+12*y+3);
// fprintf(1,'x = %.4f\ty = %.4f\n',x,y);

// Find adjacent lines to (us, vs) 
n = T.length; 
index = 0; 
d1 = ((v-vt[0]) - tt[0]*(u-ut[0]))/Math.sqrt(1+tt[0]*tt[0]); 
console.log(d1);
// for i=2:n
//     d2 = ((v-vt(i)) - tt(i)*(u-ut(i)))/sqrt(1+tt(i)*tt(i));
//     if (d1/d2 < 0)
//         index = i;
//         break;
//     else
//         d1 = d2;
//     end
// end
// if index == 0
//     Tc = -1; % Not able to calculate CCT, u, v coordinates outside range.
//     fprintf(1,'Not able to calculate CCT, u, v coordinates outside range.\n');
//     %return
// else
//     % Calculate CCT by interpolation between isotemperature lines
//     Tc = 1/(1/T(index-1)+d1/(d1-d2)*(1/T(index)-1/T(index-1)));
//     fprintf(1,'CCT = %.1f\n',Tc);
// end









